# 명령어 오류 수정 완료

## 🎯 해결된 문제들

### 1. **`*push-error-using-command*` 오류**
**오류 메시지**: "먼저 (*push-error-using-command*)를 호출하지 않으면 *error*에서 (command)를 실행할 수 없습니다."

✅ **해결책**: 모든 `command` 호출을 `command-s`로 변경
- `command` → `command-s` (10개 위치 수정)
- 에러 핸들러에서 안전하게 AutoCAD 명령 실행 가능

### 2. **XCLIP 명령 구문 오류**  
**오류 메시지**: 
- "알 수 없는 명령 '-XCLIP'"
- "알 수 없는 명령 'ALL'"  
- "알 수 없는 명령 'DELETE'"

✅ **해결책**: XCLIP 명령 구문 수정
- `"_.-XCLIP"` → `"_.XCLIP"`
- 올바른 AutoCAD 명령 형식으로 변경

## 🔧 수정된 명령어들

### AutoCAD 명령 호출 수정
```lisp
;; BEFORE (오류 발생)
(command "_.REGEN")
(command "_.zoom" "_c" center height)
(command "_.REDRAW")

;; AFTER (안전한 실행)
(command-s "_.REGEN") 
(command-s "_.zoom" "_c" center height)
(command-s "_.REDRAW")
```

### XCLIP 명령 수정
```lisp  
;; BEFORE (구문 오류)
(command "_.-XCLIP" "_ALL" "_Delete" "")

;; AFTER (올바른 구문)
(command-s "_.XCLIP" "_ALL" "_Delete" "")
```

## 🐛 레이어 분리 문제 분석

### 사용자가 경험한 상황
1. **선택한 객체**: `'!-부대'`, `'POINT_HEIGHT'` 레이어 객체
2. **메시지**: "일반 레이어만 선택되어 XREF 확장을 건너뜁니다..."
3. **결과**: 레이어 분리가 제대로 작동하지 않음

### 원인 분석
- ✅ **XREF 확장 건너뛰기는 정상**: 선택한 레이어에 `"|"` 문자가 없어서 XREF 레이어가 아님
- ❓ **레이어 분리 미작동**: 디버깅 정보 추가로 원인 파악 필요

### 추가된 디버깅
```lisp
(prompt (strcat "\n[DEBUG] 레이어 제어 시작 - 선택된 레이어: " (vl-princ-to-string target_layer_names)))
(prompt (strcat "\n[DEBUG] 페이퍼스페이스 레이어: " (vl-princ-to-string paperspace_layers)))
(prompt (strcat "\n[DEBUG] 켜는 레이어: " layer_name))
(prompt (strcat "\n[DEBUG] 끄는 레이어: " layer_name))
```

## 🎯 사용자를 위한 다음 단계

### 테스트 가이드
1. **명령어 실행**: `SR` 명령 실행
2. **레이어 분리**: Y 선택하여 레이어 분리 활성화
3. **객체 선택**: 원하는 객체 선택
4. **디버그 정보 확인**: 콘솔에 출력되는 디버그 메시지 확인

### 예상 결과
- ✅ `*push-error-using-command*` 오류 해결됨
- ✅ XCLIP 관련 "알 수 없는 명령" 오류 해결됨  
- ✅ 디버그 정보로 레이어 분리 과정 확인 가능

### 레이어 분리가 여전히 작동하지 않는다면
디버그 메시지를 확인하여:
1. 어떤 레이어가 켜지고 꺼지는지 확인
2. 페이퍼스페이스 레이어 처리 확인  
3. 추가 문제점 파악

---

**이제 AutoCAD에서 테스트해보세요!** 🚀
명령어 오류들이 해결되어 더 안정적으로 작동할 것입니다.